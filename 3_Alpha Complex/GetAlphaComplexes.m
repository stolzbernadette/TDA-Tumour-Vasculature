%% Construct alpha complex with GUDHI
% 14.12.2019

% CHANGE FILTRATION END ACCORDING TO LARGEST TUMOUR IN DATA SET?

%delete(gcp) 

clear all
clc

%initial_path = '/home/stolz/Desktop/Vessel Networks/unet-test-master/Data Bostjan Output/Skeleton Output/';

%initial_path = '/Users/user/Desktop/TDA\ software/GUDHI_2.1.0_OSX_UTILS/';

%initial_path = '/Users/bernadettestolz/Desktop/Vasculature Project/Skeleton Output/';

%initial_pathII = '/scratch/stolz/Summer17_Dataset_RT_AntiAngio/';


%initial_path = '/users/user/Desktop/Vasculature Project/Skeleton Output/';

%initial_path = '/Users/bernadettestolz/Desktop/Vasculature Project/Skeleton Output/';

categories = ["Control", "Control", "Control", "Control", "Control", ...
    "Control", "Control", "Control", "Control", "Control",...
    "Control", "Control", "Control", "Control", "Control",...
    "Control", "Control", "Control", "Control", "Control",...
    "Control", "Control", "Control", "Control", "Control",...
    "Control", "Control", "Control", "Control", "Control",...
    "Control", "Control", "Control", "Control", "Control",...
    "Control", "Control", "Control",...
    "DC101 treated", "DC101 treated", "DC101 treated", "DC101 treated", "DC101 treated",...
    "DC101 treated", "DC101 treated", "DC101 treated", "DC101 treated", "DC101 treated",...
    "DC101 treated", "DC101 treated", "DC101 treated", "DC101 treated", "DC101 treated",...
    "DC101 treated", "DC101 treated", "DC101 treated", "DC101 treated", "DC101 treated",...
    "DC101 treated", "DC101 treated", "DC101 treated", "DC101 treated", "DC101 treated",...
    "DC101 treated", "DC101 treated", "DC101 treated", "DC101 treated", "DC101 treated","DC101 treated", "DC101 treated", ...
    "Anti-Dll4 treated", "Anti-Dll4 treated", "Anti-Dll4 treated", "Anti-Dll4 treated", "Anti-Dll4 treated", ...
    "Anti-Dll4 treated", "Anti-Dll4 treated", "Anti-Dll4 treated", "Anti-Dll4 treated", "Anti-Dll4 treated", ...
    "Anti-Dll4 treated", "Anti-Dll4 treated", "Anti-Dll4 treated", "Anti-Dll4 treated", "Anti-Dll4 treated", "Anti-Dll4 treated", "Anti-Dll4 treated", ...
    "Single dose irradiation", "Single dose irradiation", "Single dose irradiation", "Single dose irradiation", "Single dose irradiation",...
    "Single dose irradiation", "Single dose irradiation", "Single dose irradiation", "Single dose irradiation", "Single dose irradiation",...
    "Single dose irradiation", "Single dose irradiation", "Single dose irradiation", "Single dose irradiation", "Single dose irradiation",...
    "Single dose irradiation", "Single dose irradiation", "Single dose irradiation", "Single dose irradiation", "Single dose irradiation",...
    "Single dose irradiation", "Single dose irradiation", "Single dose irradiation", "Single dose irradiation", "Single dose irradiation",...
    "Single dose irradiation", "Single dose irradiation", "Single dose irradiation", "Single dose irradiation", "Single dose irradiation",...
    "Control", "Control", "Control", "Control", "Control", ...
    "Single dose irradiation", "Single dose irradiation", "Single dose irradiation", "Single dose irradiation", "Single dose irradiation",...
    "Single dose irradiation", "Single dose irradiation", "Single dose irradiation", "Single dose irradiation", "Single dose irradiation",...
    "Single dose irradiation", "Single dose irradiation", "Single dose irradiation", "Single dose irradiation", "Single dose irradiation",...
    "Single dose irradiation", "Single dose irradiation", "Single dose irradiation", "Single dose irradiation",...
    "Single dose irradiation", "Single dose irradiation", "Single dose irradiation", "Single dose irradiation", "Single dose irradiation",...
    "Single dose irradiation", "Single dose irradiation", "Single dose irradiation", "Single dose irradiation", "Single dose irradiation",...
    "Single dose irradiation", "Single dose irradiation", "Single dose irradiation", "Single dose irradiation", "Single dose irradiation",...
    "Single dose irradiation", "Single dose irradiation", "Single dose irradiation", "Single dose irradiation",...
    "Fractionated irradiation","Fractionated irradiation","Fractionated irradiation","Fractionated irradiation","Fractionated irradiation",...
    "Fractionated irradiation","Fractionated irradiation","Fractionated irradiation","Fractionated irradiation","Fractionated irradiation",...
    "Fractionated irradiation","Fractionated irradiation","Fractionated irradiation","Fractionated irradiation","Fractionated irradiation",...
    "Fractionated irradiation","Fractionated irradiation","Fractionated irradiation","Fractionated irradiation","Fractionated irradiation",...
    "Fractionated irradiation","Fractionated irradiation","Fractionated irradiation","Fractionated irradiation","Fractionated irradiation",...
    "Fractionated irradiation","Fractionated irradiation","Fractionated irradiation","Fractionated irradiation","Fractionated irradiation",...
    "Fractionated irradiation","Fractionated irradiation","Fractionated irradiation","Fractionated irradiation","Fractionated irradiation",...
    "Fractionated irradiation","Fractionated irradiation","Fractionated irradiation","Fractionated irradiation","Fractionated irradiation",...
     "Fractionated irradiation","Fractionated irradiation","Fractionated irradiation","Fractionated irradiation"];

categories_short = ["Ctrl", "Ctrl", "Ctrl", "Ctrl", "Ctrl", ...
    "Ctrl", "Ctrl", "Ctrl", "Ctrl", "Ctrl",...
    "Ctrl", "Ctrl", "Ctrl", "Ctrl", "Ctrl",...
    "Ctrl", "Ctrl", "Ctrl", "Ctrl", "Ctrl",...
    "Ctrl", "Ctrl", "Ctrl", "Ctrl", "Ctrl",...
    "Ctrl", "Ctrl", "Ctrl", "Ctrl", "Ctrl",...
    "Ctrl", "Ctrl", "Ctrl", "Ctrl", "Ctrl",...
    "Ctrl", "Ctrl", "Ctrl",...
    "DC101", "DC101", "DC101", "DC101", "DC101",...
    "DC101", "DC101", "DC101", "DC101", "DC101",...
    "DC101", "DC101", "DC101", "DC101", "DC101",...
    "DC101", "DC101", "DC101", "DC101", "DC101",...
    "DC101", "DC101", "DC101", "DC101", "DC101",...
    "DC101", "DC101", "DC101", "DC101", "DC101","DC101", "DC101", ...
    "Dll4", "Dll4", "Dll4", "Dll4", "Dll4", ...
    "Dll4", "Dll4", "Dll4", "Dll4", "Dll4", ...
    "Dll4", "Dll4", "Dll4", "Dll4", "Dll4", "Dll4", "Dll4", ...
    "IR", "IR", "IR", "IR", "IR",...
    "IR", "IR", "IR", "IR", "IR",...
    "IR", "IR", "IR", "IR", "IR",...
    "IR", "IR", "IR", "IR", "IR",...
    "IR", "IR", "IR", "IR", "IR",...
    "IR", "IR", "IR", "IR", "IR",...
    "Ctrl", "Ctrl", "Ctrl", "Ctrl", "Ctrl", ...
    "IR", "IR", "IR", "IR", "IR",...
    "IR", "IR", "IR", "IR", "IR",...
    "IR", "IR", "IR", "IR", "IR",...
    "IR", "IR", "IR", "IR",...
    "IR", "IR", "IR", "IR", "IR",...
    "IR", "IR", "IR", "IR", "IR",...
    "IR", "IR", "IR", "IR", "IR",...
    "IR", "IR", "IR", "IR",...
    "FIR","FIR","FIR","FIR","FIR",...
    "FIR","FIR","FIR","FIR","FIR",...
    "FIR","FIR","FIR","FIR","FIR",...
    "FIR","FIR","FIR","FIR","FIR",...
    "FIR","FIR","FIR","FIR","FIR",...
    "FIR","FIR","FIR","FIR","FIR",...
    "FIR","FIR","FIR","FIR","FIR",...
    "FIR","FIR","FIR","FIR","FIR",...
     "FIR","FIR","FIR","FIR"];
 
tumours = ["18_4E","18_4E","18_4E","18_4E","18_4E",...
    "18_4I","18_4I","18_4I","18_4I","18_4I","18_4I","18_4I",...
    "24_2C", "24_2C", "24_2C", "24_2C","24_2C",...
    "29_1B_MC38", "29_1B_MC38", "29_1B_MC38", "29_1B_MC38", "29_1B_MC38", "29_1B_MC38","29_1B_MC38", ...
    "34_2A_MC38", "34_2A_MC38", "34_2A_MC38", "34_2A_MC38", "34_2A_MC38", "34_2A_MC38", "34_2A_MC38","34_2A_MC38", ...
    "VEOM 18_2C", "VEOM 18_2C", "VEOM 18_2C", "VEOM 18_2C", "VEOM 18_2C", "VEOM 18_2C", ...
    "33_2I_MC38_DC101", "33_2I_MC38_DC101", "33_2I_MC38_DC101", "33_2I_MC38_DC101", "33_2I_MC38_DC101", "33_2I_MC38_DC101", "33_2I_MC38_DC101", "33_2I_MC38_DC101", "33_2I_MC38_DC101",...
    "51_2C_MC38_DC101", "51_2C_MC38_DC101", "51_2C_MC38_DC101", "51_2C_MC38_DC101", "51_2C_MC38_DC101", "51_2C_MC38_DC101","51_2C_MC38_DC101",  ...
    "51_3A_MC38_DC101", "51_3A_MC38_DC101", "51_3A_MC38_DC101", "51_3A_MC38_DC101", "51_3A_MC38_DC101", ...
    "52_2F_MC38_DC101", "52_2F_MC38_DC101", "52_2F_MC38_DC101", "52_2F_MC38_DC101", "52_2F_MC38_DC101", "52_2F_MC38_DC101", ...
    "54_2D_MC38_DC101", "54_2D_MC38_DC101", "54_2D_MC38_DC101", "54_2D_MC38_DC101", "54_2D_MC38_DC101", ...
    "18_4F_DLL4", "18_4F_DLL4", "18_4F_DLL4", "18_4F_DLL4", "18_4F_DLL4", "18_4F_DLL4", ...
    "24_2A_DLL4", "24_2A_DLL4", "24_2A_DLL4","24_2A_DLL4", "24_2A_DLL4", ...
    "29_2D_MC38_DLL4", "29_2D_MC38_DLL4", "29_2D_MC38_DLL4", "29_2D_MC38_DLL4", "29_2D_MC38_DLL4", "29_2D_MC38_DLL4", ...
    "18_2D_IR", "18_2D_IR", "18_2D_IR", "18_2D_IR", "18_2D_IR", "18_2D_IR", "18_2D_IR", ...
    "24_2B_IR", "24_2B_IR", "24_2B_IR", "24_2B_IR", "24_2B_IR", "24_2B_IR", "24_2B_IR", "24_2B_IR", "24_2B_IR", "24_2B_IR", "24_2B_IR", ...
    "33_2B_IR", "33_2B_IR", "33_2B_IR", "33_2B_IR", "33_2B_IR", "33_2B_IR", "33_2B_IR", "33_2B_IR", "33_2B_IR", "33_2B_IR", "33_2B_IR", "33_2B_IR",...
    "60_2A","60_2A","60_2A","60_2A","60_2A",...
    "18_3A","18_3A","18_3A","18_3A","18_3A",...
    "18_3A","18_3A","18_3A",...
    "18_4C","18_4C","18_4C","18_4C","18_4C",...
    "18_4C","18_4C","18_4C","18_4C","18_4C",...
    "18_4C",...
    "35_2C","35_2C","35_2C","35_2C","35_2C",...
    "35_2C","35_2C","35_2C","35_2C","35_2C",...
    "47_1I","47_1I","47_1I","47_1I","47_1I",...
    "47_1I","47_1I","47_1I","47_1I",...
    "60_1C","60_1C","60_1C","60_1C","60_1C",...
    "60_1C","60_1C","60_1C","60_1C","60_1C",...
    "60_1C","60_1C","60_1C",...
    "60_1E","60_1E","60_1E","60_1E","60_1E",...
    "60_1E","60_1E","60_1E","60_1E",...
    "63_3A","63_3A","63_3A","63_3A","63_3A",...
    "63_3A","63_3A","63_3A","63_3A","63_3A",...
    "63_3A","63_3A",...
    "63_3C","63_3C","63_3C","63_3C","63_3C",...
    "63_3C","63_3C","63_3C","63_3C","63_3C"];
    
       
    
days = ["14", "15", "16", "17","18",...
    "9", "10", "11", "12", "13", "14", "15",...
    "13", "14", "15", "16","17",...
    "10", "11", "12", "13", "14","15", "16",...
    "9", "10", "11", "12", "13","14", ...
    "15","16",...
    "12", "13", "14", "15","16","17",...
    "11", "12", "13", "14", "15","16","17","18", "19",...
    "18", "19", "20", "14","15",...
    "16","17",...
    "14", "15","16","17", "13",...
    "13", "14", "15","16","17","18",...
    "15","16","17",...
    "18", "19",...
    "9", "10", "11", "12", "13", "14",...
    "10", "11", "12", "13", "14",...
    "10", "11", "12", "13", "14", "15",...
    "9","10", "11", "12", "13", "14", "15",...
    "8", "9", "10", "11", "12", "13", "14", "15","16","17","18",...
    "9", "10", "11", "12", "13", "14", "15","16","17","18","19", "20",...
    "10", "11", "12", "13", "14",...
    "10", "11", "12", "13", "14",...
    "15", "16", "17",...
    "10", "11", "12", "13", "14",...
    "15", "16", "17","18","19","20",...
    "12", "13", "14", "15", "16",...
    "17", "18", "19", "20", "21",...
    "11", "12", "13", "14", "15",...
    "16","17", "18", "19",...
    "10","11", "12", "13", "14",...
    "15","16","17", "18", "19", ...
    "20","21","22",...
    "11", "12", "13", "14", "15",...
    "16","17", "18", "19",...
    "10","11", "12", "13", "14",...
    "15","16","17", "18", "19", ...
    "20","21",...
    "11", "12", "13", "14","15",...
    "16","17", "18", "19","20"];

    
file_ids = ["18_4E_Day_14", "18_4E_Day_15", "18_4E_Day_16", ...
"18_4E_Day_17", "18_4E_Day_18", ...
"18_4I_Day_9", "18_4I_Day_10", "18_4I_Day_11", "18_4I_Day_12", "18_4I_Day_13", "18_4I_Day_14", "18_4I_Day_15",...
"24_2C_Day_13", "24_2C_Day_14", "24_2C_Day_15", "24_2C_Day_16", "24_2C_Day_17",...
"29_1B_Day_10", "29_1B_Day_11", "29_1B_Day_12", "29_1B_Day_13", "29_1B_Day_14","29_1B_Day_15","29_1B_Day_16",...
"34_2A_Day_9", "34_2A_Day_10", "34_2A_Day_11", "34_2A_Day_12", "34_2A_Day_13","34_2A_Day_14", ...
"34_2A_Day_15", "34_2A_Day_16",...
"18_2C_Day_12", "18_2C_Day_13", "18_2C_Day_14", "18_2C_Day_15", "18_2C_Day_16", "18_2C_Day_17",...
"MC38_33_2I_Day_11", "MC38_33_2I_Day_12", "MC38_33_2I_Day_13", "MC38_33_2I_Day_14", "MC38_33_2I_Day_15", "MC38_33_2I_Day_16", "MC38_33_2I_Day_17", "MC38_33_2I_Day_18", "MC38_33_2I_Day_19", ...
"MC38_51_2C_Day_18", "MC38_51_2C_Day_19", "MC38_51_2C_Day_20", "MC38_51_2C_Day_14_", "MC38_51_2C_Day_15", ...
"MC38_51_2C_Day_16", "MC38_51_2C_Day_17", ...
"MC38_51_3A_Day_14", "MC38_51_3A_Day_15", "MC38_51_3A_Day_16", "MC38_51_3A_Day_17", "MC38_51_3A_Day_13", ...
"MC38_52_2F_Day_13", "MC38_52_2F_Day_14_", "MC38_52_2F_Day_15", "MC38_52_2F_Day_16", "MC38_52_2F_Day_17", "MC38_52_2F_Day_18",...
"MC38_52_4D_Day_15", "MC38_52_4D_Day_16","MC38_52_4D_Day_17", ...
"MC38_52_4D_Day_18", "MC38_52_4D_Day_19", ...
"18_4F_Day_9", "18_4F_Day_10", "18_4F_Day_11", "18_4F_Day_12","18_4F_Day_13", "18_4F_Day_14",...
"24_2A_Day_10", "24_2A_Day_11", "24_2A_Day_12","24_2A_Day_13", "24_2A_Day_14",...
"MC38_29_2D_Day_10", "MC38_29_2D_Day_11", "MC38_29_2D_Day_12","MC38_29_2D_Day_13", "MC38_29_2D_Day_14", "MC38_29_2D_Day_15",...
"18_2D_Day_9_", "18_2D_Day_10","18_2D_Day_11", "18_2D_Day_12", "18_2D_Day_13", "18_2D_Day_14", "18_2D_Day_15",...
"24_2B_Day_8", "24_2B_Day_9", "24_2B_Day_10", "24_2B_Day_11", "24_2B_Day_12", "24_2B_Day_13", "24_2B_Day_14", "24_2B_Day_15", "24_2B_Day_16", "24_2B_Day_17", "24_2B_Day_18",...
"33_2B_Day_9", "33_2B_Day_10 ", "33_2B_Day_11", "33_2B_Day_12", "33_2B_Day_13", "33_2B_Day_14", "33_2B_Day_15", "33_2B_Day_16", "33_2B_Day_17", "33_2B_Day_18", "33_2B_Day_19", "33_2B_Day_20",...
"60_2A_Day 10", "60_2A_Day 11", "60_2A_Day 12", "60_2A_Day 13","60_2A_Day 14", ...
    "18_3A_Day 10","18_3A_Day 11","18_3A_Day 12","18_3A_Day 13","18_3A_Day 14",...
    "18_3A_Day 15","18_3A_Day 16","18_3A_Day 17",...
    "18_4C_Day 10_IR","18_4C_Day 11_IR_1","18_4C_Day 12_IR_2","18_4C_Day 13_IR_3","18_4C_Day 14_IR_4",...
    "18_4C_Day 15_IR_5","18_4C_Day 16_IR_6","18_4C_Day 17_IR_7","18_4C_Day 18_IR_8","18_4C_Day 19_IR_9","18_4C_Day 20_IR_10",...
    "35_2C_Day 12_Stitch","35_2C_Day 13_IR 1_Stitch","35_2C_Day 14_IR 2_Stitch",...
    "35_2C_Day 15_IR 3_Stitch","35_2C_Day 16_IR 4_Stitch","35_2C_Day 17_IR 5_Stitch",...
    "35_2C_Day 18_IR 6_Stitch","35_2C_Day 19_IR 7_Stitch","35_2C_Day 20_IR 8_Stitch",...
    "35_2C_Day 21_IR 9_Stitch",...
    "47_1I_Day 11_IR 1","47_1I_Day 12_IR 2","47_1I_Day 13_IR 3","47_1I_Day 14_IR 4_Stitch",...
    "47_1I_Day 15_IR 5_Stitch","47_1I_Day 16_IR 6_Stitch","47_1I_Day 17_IR 7_Stitch","47_1I_Day 18_IR 8_Stitch",...
    "47_1I_Day 19_IR 9_Stitch",...
    "60_1C_Day 10","60_1C_Day 11","60_1C_Day 12","60_1C_Day 13","60_1C_Day 14",...
    "60_1C_Day 15","60_1C_Day 16","60_1C_Day 17","60_1C_Day 18","60_1C_Day 19",...
    "60_1C_Day 20","60_1C_Day 21","60_1C_Day 22",...
    "60_1E_Day 11","60_1E_Day 12","60_1E_Day 13","60_1E_Day 14","60_1E_Day 15",...
    "60_1E_Day 16","60_1E_Day 17","60_1E_Day 18","60_1E_Day 19",...
    "63_3A_Day 10","63_3A_Day 11","63_3A_Day 12","63_3A_Day 13","63_3A_Day 14",...
    "63_3A_Day 15","63_3A_Day 16","63_3A_Day 17","63_3A_Day 18","63_3A_Day 19",...
    "63_3A_Day 20","63_3A_Day 21",...
    "63_3C_Day 11","63_3C_Day 12","63_3C_Day 13","63_3C_Day 14","63_3C_Day 15",...
    "63_3C_Day 16","63_3C_Day 17","63_3C_Day 18","63_3C_Day 19","63_3C_Day 20"];



folders = ["Ctrl/18_4E/18_4E_Day 14/", "Ctrl/18_4E/18_4E_Day 15/", "Ctrl/18_4E/18_4E_Day 16/", ...
"Ctrl/18_4E/18_4E_Day 17/", "Ctrl/18_4E/18_4E_Day 18/",...
"Ctrl/18_4I/18_4I_Day 9/", ...
"Ctrl/18_4I/18_4I_Day 10/", "Ctrl/18_4I/18_4I_Day 11/", "Ctrl/18_4I/18_4I_Day 12/", ...
"Ctrl/18_4I/18_4I_Day 13/", "Ctrl/18_4I/18_4I_Day 14/", "Ctrl/18_4I/18_4I_Day 15/", ...
"Ctrl/24_2C/24_2C_Day 13/", "Ctrl/24_2C/24_2C_Day 14/", "Ctrl/24_2C/24_2C_Day 15/", ...
"Ctrl/24_2C/24_2C_Day 16/", "Ctrl/24_2C/24_2C_Day 17/", ...
"Ctrl/29_1B_MC38/29_1B_Day 10/", ...
"Ctrl/29_1B_MC38/29_1B_Day 11/", "Ctrl/29_1B_MC38/29_1B_Day 12/", "Ctrl/29_1B_MC38/29_1B_Day 13/", ...
"Ctrl/29_1B_MC38/29_1B_Day 14/", "Ctrl/29_1B_MC38/29_1B_Day 15/", "Ctrl/29_1B_MC38/29_1B_Day 16/", ...
"Ctrl/34_2A_MC38/Outputs/34_2A_Day 9/", "Ctrl/34_2A_MC38/Outputs/34_2A_Day 10/", ...
"Ctrl/34_2A_MC38/Outputs/34_2A_Day 11/", "Ctrl/34_2A_MC38/Outputs/34_2A_Day 12/", ...
"Ctrl/34_2A_MC38/Outputs/34_2A_Day 13_Stitch/","Ctrl/34_2A_MC38/Outputs/34_2A_Day 14_Stitch/", ...
"Ctrl/34_2A_MC38/Outputs/34_2A_Day 15_Stitch/", "Ctrl/34_2A_MC38/Outputs/34_2A_Day 16_Stitch/", ...
"Ctrl/VEOM 18_2C/Outputs/18_2C_Day 12/", "Ctrl/VEOM 18_2C/Outputs/18_2C_Day 13/", ...
"Ctrl/VEOM 18_2C/Outputs/18_2C_Day 14/", "Ctrl/VEOM 18_2C/Outputs/18_2C_Day 15/", ...
"Ctrl/VEOM 18_2C/Outputs/18_2C_Day 16/", "Ctrl/VEOM 18_2C/Outputs/18_2C_Day 17/", ...
"DC101/33_2I_MC38_DC101/Outputs/33_2I_Day 11/", "DC101/33_2I_MC38_DC101/Outputs/33_2I_Day 12_Stitch/", ...
"DC101/33_2I_MC38_DC101/Outputs/33_2I_Day 13_Stitch/", "DC101/33_2I_MC38_DC101/Outputs/33_2I_Day 14_Stitch/", ...
"DC101/33_2I_MC38_DC101/Outputs/33_2I_Day 15_Stitch/", "DC101/33_2I_MC38_DC101/Outputs/33_2I_Day 16_Stitch/", ...
"DC101/33_2I_MC38_DC101/Outputs/33_2I_Day 17_Stitch/", "DC101/33_2I_MC38_DC101/Outputs/33_2I_Day 18_Stitch/", ...
"DC101/33_2I_MC38_DC101/Outputs/33_2I_Day 19_Stitch/", "DC101/51_2C_MC38_DC101/Outputs/51_2C_day 18_Stitch/", ...
"DC101/51_2C_MC38_DC101/Outputs/51_2C_day 19_Stitch/", "DC101/51_2C_MC38_DC101/Outputs/51_2C_day 20_Stitch/", ...
"DC101/51_2C_MC38_DC101/Outputs/51_2C_Day 14_DC101/", "DC101/51_2C_MC38_DC101/Outputs/51_2C_Day 15/", ...
"DC101/51_2C_MC38_DC101/Outputs/51_2C_Day 16_Stitch/", "DC101/51_2C_MC38_DC101/Outputs/51_2C_Day 17_DC101_Stitch/",...
"DC101/51_3A_MC38_DC101/Outputs/51_3A_day 14_Stitch/", "DC101/51_3A_MC38_DC101/Outputs/51_3A_day 15_Stitch/", ...
"DC101/51_3A_MC38_DC101/Outputs/51_3A_day 16_Stitch/", "DC101/51_3A_MC38_DC101/Outputs/51_3A_day 17_Stitch/", ...
"DC101/51_3A_MC38_DC101/Outputs/51_3A_Day 13_DC101_Stitch/", "DC101/52_2F_MC38_DC101/Outputs/52_2F_Day 13/", ...
"DC101/52_2F_MC38_DC101/Outputs/52_2F_Day 14_DC101/", "DC101/52_2F_MC38_DC101/Outputs/52_2F_Day 15_Stitch/", ...
"DC101/52_2F_MC38_DC101/Outputs/52_2F_Day 16_Stitch/", "DC101/52_2F_MC38_DC101/Outputs/52_2F_Day 17_DC101_Stitch/", ...
"DC101/52_2F_MC38_DC101/Outputs/52_2F_Day 18_Stitch/", "DC101/54_2D_MC38_DC101/Outputs/52_4D_day 15_DC101_Stitch/", ...
"DC101/54_2D_MC38_DC101/Outputs/52_4D_day 16_stitch/", "DC101/54_2D_MC38_DC101/Outputs/52_4D_day 17_stitch/", ...
"DC101/54_2D_MC38_DC101/Outputs/52_4D_day 18_DC101_stitch/", "DC101/54_2D_MC38_DC101/Outputs/52_4D_day 19_stitch/", ...
"Dll4/18_4F_DLL4/Outputs_new_model/18_4F_Day 9/", "Dll4/18_4F_DLL4/Outputs_new_model/18_4F_Day 10/", ...
"Dll4/18_4F_DLL4/Outputs_new_model/18_4F_Day 11/", "Dll4/18_4F_DLL4/Outputs_new_model/18_4F_Day 12/", ...
"Dll4/18_4F_DLL4/Outputs_new_model/18_4F_Day 13/", "Dll4/18_4F_DLL4/Outputs_new_model/18_4F_Day 14/", ...
"Dll4/24_2A_DLL4/Outputs/24_2A_Day 10/", "Dll4/24_2A_DLL4/Outputs/24_2A_Day 11/", ...
"Dll4/24_2A_DLL4/Outputs/24_2A_Day 12/","Dll4/24_2A_DLL4/Outputs/24_2A_Day 13/", "Dll4/24_2A_DLL4/Outputs/24_2A_Day 14/",...
"Dll4/29_2D_MC38_DLL4/Outputs/29_2D_Day 10_Dll4_1/", ...
"Dll4/29_2D_MC38_DLL4/Outputs/29_2D_Day 11_Dll4_2/", "Dll4/29_2D_MC38_DLL4/Outputs/29_2D_Day 12_Dll4_3/", ...
"Dll4/29_2D_MC38_DLL4/Outputs/29_2D_Day 13_Dll4_4/", "Dll4/29_2D_MC38_DLL4/Outputs/29_2D_Day 14_Dll4_5/", ...
"Dll4/29_2D_MC38_DLL4/Outputs/29_2D_Day 15_Dll4_6/","IR/18_2D_IR/18_2D_Day 9_IR/", "IR/18_2D_IR/18_2D_Day 10/", ...
"IR/18_2D_IR/18_2D_Day 11/", "IR/18_2D_IR/18_2D_Day 12/", "IR/18_2D_IR/18_2D_Day 13/", "IR/18_2D_IR/18_2D_Day 14/", ...
"IR/18_2D_IR/18_2D_Day 15/","IR/24_2B_IR/24_2B_Day 8/", "IR/24_2B_IR/24_2B_Day 9_IR_1/", "IR/24_2B_IR/24_2B_Day 10_IR_2/", ...
"IR/24_2B_IR/24_2B_Day 11_IR_3/", "IR/24_2B_IR/24_2B_Day 12_IR_4/", "IR/24_2B_IR/24_2B_Day 13_IR_5/", ...
"IR/24_2B_IR/24_2B_Day 14_IR_6/", "IR/24_2B_IR/24_2B_Day 15_IR_7/", "IR/24_2B_IR/24_2B_Day 16_IR_8/", ...
"IR/24_2B_IR/24_2B_Day 17_IR_09/", "IR/24_2B_IR/24_2B_Day 18_IR_10/", "IR/33_2B_IR/33_2B_Day 9/", ...
"IR/33_2B_IR/33_2B_Day 10 IR/", "IR/33_2B_IR/33_2B_Day 11_IR 1/", "IR/33_2B_IR/33_2B_Day 12_IR 2/", ...
"IR/33_2B_IR/33_2B_Day 13_IR 3_Stitch/", "IR/33_2B_IR/33_2B_Day 14_IR 4_Stitch/", ...
"IR/33_2B_IR/33_2B_Day 15_IR 5_Stitch/", "IR/33_2B_IR/33_2B_Day 16_IR 6_Stitch/", ...
"IR/33_2B_IR/33_2B_Day 17_IR 7_Stitch/", "IR/33_2B_IR/33_2B_Day 18_IR 8/", "IR/33_2B_IR/33_2B_Day 19_IR 9/", ...
"IR/33_2B_IR/33_2B_Day 20_IR 10/",...
"Ctrl/60_2A_MC38/Outputs/60_2A_Day 10/", "Ctrl/60_2A_MC38/Outputs/60_2A_Day 11/", "Ctrl/60_2A_MC38/Outputs/60_2A_Day 12/",...
"Ctrl/60_2A_MC38/Outputs/60_2A_Day 13/", "Ctrl/60_2A_MC38/Outputs/60_2A_Day 14/",...
"IR/18_3A_IR/18_3A_Day 10/", "IR/18_3A_IR/18_3A_Day 11/", "IR/18_3A_IR/18_3A_Day 12/", "IR/18_3A_IR/18_3A_Day 13/",...
"IR/18_3A_IR/18_3A_Day 14/", "IR/18_3A_IR/18_3A_Day 15/", "IR/18_3A_IR/18_3A_Day 16/", "IR/18_3A_IR/18_3A_Day 17/",...
"IR/18_4C_IR/18_4C_Day 10_IR/", "IR/18_4C_IR/18_4C_Day 11_IR_1/", "IR/18_4C_IR/18_4C_Day 12_IR_2/", "IR/18_4C_IR/18_4C_Day 13_IR_3/",...
"IR/18_4C_IR/18_4C_Day 14_IR_4/", "IR/18_4C_IR/18_4C_Day 15_IR_5/", "IR/18_4C_IR/18_4C_Day 16_IR_6/", "IR/18_4C_IR/18_4C_Day 17_IR_7/",...
"IR/18_4C_IR/18_4C_Day 18_IR_8/", "IR/18_4C_IR/18_4C_Day 19_IR_9/", "IR/18_4C_IR/18_4C_Day 20_IR_10/",...
"IR/35_2C_IR/Outputs/35_2C_Day 12_Stitch/", "IR/35_2C_IR/Outputs/35_2C_Day 13_IR 1_Stitch/",...
"IR/35_2C_IR/Outputs/35_2C_Day 14_IR 2_Stitch/", "IR/35_2C_IR/Outputs/35_2C_Day 15_IR 3_Stitch/",...
"IR/35_2C_IR/Outputs/35_2C_Day 16_IR 4_Stitch/","IR/35_2C_IR/Outputs/35_2C_Day 17_IR 5_Stitch/",...
"IR/35_2C_IR/Outputs/35_2C_Day 18_IR 6_Stitch/", "IR/35_2C_IR/Outputs/35_2C_Day 19_IR 7_Stitch/",...
"IR/35_2C_IR/Outputs/35_2C_Day 20_IR 8_Stitch/", "IR/35_2C_IR/Outputs/35_2C_Day 21_IR 9_Stitch/",...
"IR/47_1I_IR/Outputs/47_1I_Day 11_IR 1/", "IR/47_1I_IR/Outputs/47_1I_Day 12_IR 2/", "IR/47_1I_IR/Outputs/47_1I_Day 13_IR 3/",...
"IR/47_1I_IR/Outputs/47_1I_Day 14_IR 4_Stitch/", "IR/47_1I_IR/Outputs/47_1I_Day 15_IR 5_Stitch/", "IR/47_1I_IR/Outputs/47_1I_Day 16_IR 6_Stitch/",...
"IR/47_1I_IR/Outputs/47_1I_Day 17_IR 7_Stitch/", "IR/47_1I_IR/Outputs/47_1I_Day 18_IR 8_Stitch/", "IR/47_1I_IR/Outputs/47_1I_Day 19_IR 9_Stitch/",...
"FIR/60_1C_FIR/Outputs/60_1C_Day 10/", "FIR/60_1C_FIR/Outputs/60_1C_Day 11/", "FIR/60_1C_FIR/Outputs/60_1C_Day 12/",...
"FIR/60_1C_FIR/Outputs/60_1C_Day 13/", "FIR/60_1C_FIR/Outputs/60_1C_Day 14/", "FIR/60_1C_FIR/Outputs/60_1C_Day 15/",...
"FIR/60_1C_FIR/Outputs/60_1C_Day 16/", "FIR/60_1C_FIR/Outputs/60_1C_Day 17/", "FIR/60_1C_FIR/Outputs/60_1C_Day 18/",...
"FIR/60_1C_FIR/Outputs/60_1C_Day 19/", "FIR/60_1C_FIR/Outputs/60_1C_Day 20/", "FIR/60_1C_FIR/Outputs/60_1C_Day 21/",...
"FIR/60_1C_FIR/Outputs/60_1C_Day 22/",...
"FIR/60_1E_FIR/Outputs/60_1E_Day 11/", "FIR/60_1E_FIR/Outputs/60_1E_Day 12/", "FIR/60_1E_FIR/Outputs/60_1E_Day 13/",...
"FIR/60_1E_FIR/Outputs/60_1E_Day 14/", "FIR/60_1E_FIR/Outputs/60_1E_Day 15/", "FIR/60_1E_FIR/Outputs/60_1E_Day 16/",...
"FIR/60_1E_FIR/Outputs/60_1E_Day 17/", "FIR/60_1E_FIR/Outputs/60_1E_Day 18/", "FIR/60_1E_FIR/Outputs/60_1E_Day 19/",...
"FIR/63_3A_FIR/Outputs/63_3A_Day 10/", "FIR/63_3A_FIR/Outputs/63_3A_Day 11/", "FIR/63_3A_FIR/Outputs/63_3A_Day 12/",...
"FIR/63_3A_FIR/Outputs/63_3A_Day 13/", "FIR/63_3A_FIR/Outputs/63_3A_Day 14/", "FIR/63_3A_FIR/Outputs/63_3A_Day 15/",...
"FIR/63_3A_FIR/Outputs/63_3A_Day 16/", "FIR/63_3A_FIR/Outputs/63_3A_Day 17/", "FIR/63_3A_FIR/Outputs/63_3A_Day 18/",...
"FIR/63_3A_FIR/Outputs/63_3A_Day 19/", "FIR/63_3A_FIR/Outputs/63_3A_Day 20/", "FIR/63_3A_FIR/Outputs/63_3A_Day 21/",...
"FIR/63_3C_FIR/Outputs/63_3C_Day 11/", "FIR/63_3C_FIR/Outputs/63_3C_Day 12/", "FIR/63_3C_FIR/Outputs/63_3C_Day 13/",...
"FIR/63_3C_FIR/Outputs/63_3C_Day 14/", "FIR/63_3C_FIR/Outputs/63_3C_Day 15/", "FIR/63_3C_FIR/Outputs/63_3C_Day 16/",...
"FIR/63_3C_FIR/Outputs/63_3C_Day 17/", "FIR/63_3C_FIR/Outputs/63_3C_Day 18/", "FIR/63_3C_FIR/Outputs/63_3C_Day 19/",...
"FIR/63_3C_FIR/Outputs/63_3C_Day 20/"];
 

file_ids = [];


parfor data_file_number = 1:length(tumours)
    
    tumour = tumours(data_file_number);
    day = days(data_file_number);
    folder = folders(data_file_number);
    category = categories(data_file_number);
    
    short_category = categories_short(data_file_number);
    
    point_cloud_filename2 =  [char(short_category) '_' char(tumour) '_'  char(day)];
    
    point_cloud_filename =  [char(tumour) '_'  char(day)];

    input_path = char(['input/' num2str(point_cloud_filename) '.txt']);
    
    output_path = ['output/' num2str(point_cloud_filename2) '.txt'];
    
    sprintf(['GUDHI code opened file for ' point_cloud_filename])

    unixstring=['./alpha_complex_persistence -p 2 -o ' output_path ' ' input_path];
    [status,cmdout] = unix(unixstring);
    
    gudhi_reformat_output( output_path );
    
    filename = ['output/Barcodes/' point_cloud_filename '_alpha'];
    
    header = [char(category) ' ' char(tumour) ' day '  char(day)];
    
    starts_and_ends = importdata(['output/' num2str(point_cloud_filename2) '_dim2.txt']);
    
    plot_barcodes_mod( filename,header, starts_and_ends, 2);
    
    sprintf(['Done with folder ' char(point_cloud_filename)])

    
end

delete(gcp) 

